<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <style media="screen">

      section {
        max-width: 600px;
        margin: 0 auto;
        overflow: hidden;
      }

      .module {
        width: 33.33337%;
        height: 200px;
        position: relative;
        float: left;
        padding: 0px;
        margin-bottom: 4%;
      }

      .module:nth-child(odd) {
        background: blue;
      }
      .module:nth-child(even) {
        background: red;
      }

      body {
        margin: 0px;
      }

      .come-in {
        animation: come-in 0.4s ease forwards;
      }
      .come-in:nth-child(odd) {
        animation-duration: 0.6s;
      }

      @keyframes come-in {
        from { transform: translateY(150px); }
        to { transform: translateY(0); }
      }

    </style>
  </head>
  <body>

    <section>

      <div class="module" module_id="1"></div>
      <div class="module" module_id="2"></div>
      <div class="module" module_id="3"></div>
      <div class="module" module_id="4"></div>
      <div class="module" module_id="5"></div>
      <div class="module" module_id="6"></div>
      <div class="module" module_id="7"></div>
      <div class="module" module_id="8"></div>
      <div class="module" module_id="9"></div>
      <div class="module" module_id="10"></div>
      <div class="module" module_id="11"></div>
      <div class="module" module_id="12"></div>
      <div class="module" module_id="13"></div>
      <div class="module" module_id="14"></div>
      <div class="module" module_id="15"></div>
      <div class="module" module_id="16"></div>
      <div class="module" module_id="17"></div>
      <div class="module" module_id="18"></div>
      <div class="module" module_id="19"></div>
      <div class="module" module_id="20"></div>
      <div class="module" module_id="21"></div>
      <div class="module" module_id="22"></div>
      <div class="module" module_id="23"></div>
      <div class="module" module_id="24"></div>
      <div class="module" module_id="25"></div>

    </section>




    <script type="text/javascript">
    var ele = document.querySelectorAll('.module');
    var ele_array = [];
    for (var i = 0; i < ele.length; i++) {
        ele_array.push({
            uid: ele[i].getAttribute('module_id'),
            div: ele[i]
        });
    }

    ele_array.sort(function(a, b) {
      return parseFloat(a.uid) - parseFloat(b.uid);
    });

    //console.log(ele_array);
    for (var i = 0; i < ele_array.length; i++) {
      if ((i % 2) == 0) {
        ele_array[i].div.style.animationDuration = "1s";
      }
      if ((i % 2) != 0) {
        ele_array[i].div.style.animationDuration = "0.5s";
      }
    }


    var w = Math.max(document.documentElement.clientWidth, window.innerWidth || 0)
    var h = Math.max(document.documentElement.clientHeight, window.innerHeight || 0)

    function showRect(elem) {
      var r = elem.getBoundingClientRect()
      return { top:r.top, bottom:r.bottom}
    }

    console.log(ele_array[0].div);

    for (var i = 0; i < ele_array.length; i++) {
      var kava = (showRect(ele_array[i].div).top+(ele_array[i].div.clientHeight/3));
      if (kava <= h) {
        ele_array[i].div.style.animationDuration = "0s";
        ele_array[i].div.style.opacity = 1;
      } else {
        ele_array[i].div.style.opacity = 0;
      }
    }

    window.addEventListener('scroll', function() {
      for (var i = 0; i < ele_array.length; i++) {
        var kava = (showRect(ele_array[i].div).top+(ele_array[i].div.clientHeight/3));
        if (kava <= h) {
          ele_array[i].div.style.opacity = 1;
          ele_array[i].div.classList.add('come-in');
        }
      }
    })

    </script>

  </body>
</html>
